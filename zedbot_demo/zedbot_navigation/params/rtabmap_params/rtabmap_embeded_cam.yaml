# RTAB-Map configuration

subscribe_depth:        true
subscribe_rgbd:         false
subscribe_stereo:       false
subscribe_stereo:       false
subscribe_scan:         false
subscribe_scan_cloud:   false
subscribe_user_data:    false
subscribe_odom_info:    false

database_path:      "~/.ros/rtabmap.db"
config_path:        "~/.ros/rtabmap.cfg"

frame_id:       "/base_link"
map_frame_id:   "/map"
odom_frame_id:  "/odom"                   # odometry from odom msg to have covariance - Remapped by launch file
odom_tf_angular_variance:  0.001     # If TF is used to get odometry, this is the default angular variance
odom_tf_linear_variance:   0.001     # If TF is used to get odometry, this is the default linear variance
tf_delay:       0.02
publish_tf:     true                 # Set to false if fusing different poses (map->odom) with UKF

odom_sensor_sync:               false
wait_for_transform_duration:    0.2
approx_sync:                    true

queue_size: 10

scan_normal_k:  0
Rtabmap:
    DetectionRate : 4                  #"Detection rate (Hz). RTAB-Map will filter input images to satisfy this rate."


RGBD:
    LinearUpdate:           0.05              #"Minimum linear displacement (m) to update the map. Rehearsal is done prior to this, so weights are still updated."
    AngularUpdate:          0.05
    CreateOccupancyGrid:    true

Grid:
    3D:                     false        #A 3D occupancy grid is required if you want an OctoMap (3D ray tracing). 
                                         #Set to false if you want only a 2D map, the cloud will be projected on xy plane. 
                                         #A 2D map can be still generated if checked, but it requires more memory and time to generate it. Ignored if laser scan is 2D and \"%s\" is false."
    FlatObstacleDetected:   true
    MapFrameProjection:     false        #Projection in map frame. On a 3D terrain and a fixed local camera transform (the cloud is created relative to ground), you may want to disable this to do the projection in robot frame instead."
    GroundIsObstacle:       false
    PreVoxelFiltering:      true
    RayTracing:             true
    FromDepth:              true         #"Create occupancy grid from depth image(s), otherwise it is created from laser scan."
    NormalsSegmentation:    false
    CellSize:               0.04
    ClusterRadius:          1
    MinClusterSize:         3
    DepthDecimation:        1
    DepthRoiRatios:         [0.0, 0.0, 0.0, 0.0]   #Region of interest ratios [left, right, top, bottom].
    FootprintHeight:        0.2
    FootprintLength:        0.15
    FootprintWidth:         0.15
    MaxGroundAngle:         45.0         # in degree
    MinGroundHeight:        0      #Minimum ground height (0=disabled).
    MaxGroundHeight:        0.07
    MaxObstacleHeight:      0.28
    NoiseFilteringMinNeighbors: 5
    NoiseFilteringRadius:   0.1
    NormalK:                20
    RangeMin:               0.3         #"Minimum range from sensor."
    RangeMax:               4           # should be set if "Grid/NormalsSegmentation" is false

GridGlobal:
    Eroded:                 false       # Erode obstacle cells
    FootprintRadius:        0.08        # Footprint radius (m) used to clear all obstacles under the graph
    FullUpdate:             true        # When the graph is changed, the whole map will be reconstructed instead of moving individually each cells of the map. Also, data added to cache won't be released after updating the map. This process is longer but more robust to drift that would erase some parts of the map when it should not
    MaxNodes:               0           # Maximum nodes assembled in the map starting from the last node (0=unlimited)
    MinSize:                5.0        # Minimum map size (m)
    OccupancyThr:           0.55        # Occupancy threshold (value between 0 and 1)
    ProbClampingMax:        0.971       # Probability clamping maximum (value between 0 and 1)
    ProbClampingMin:        0.1192      # Probability clamping minimum (value between 0 and 1)
    ProbHit:                0.7         # Probability of a hit (value between 0.5 and 1)
    ProbMiss:               0.3          # Probability of a miss (value between 0 and 0.5)
    UpdateError:            0.01        # Graph changed detection error (m). Update map only if poses in new optimized graph have moved more than this value


